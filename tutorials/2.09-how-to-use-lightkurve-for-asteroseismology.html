

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to use lightkurve for asteroseismology &mdash; lightkurve 1.0b9 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="lightkurve 1.0b9 documentation" href="../index.html"/>
        <link rel="up" title="Science with lightkurve" href="section2.html"/>
        <link rel="next" title="How to make a supernova lightcurve" href="2.10-how-to-make-a-supernova-lightcurve.html"/>
        <link rel="prev" title="How to store a light curve in FITS format?" href="2.08-making-fits-files.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> lightkurve
          

          
            
            <img src="../_static/lightkurve.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0b9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="section1.html">Introduction to lightkurve</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="section2.html">Science with lightkurve</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2.02-recover-a-planet.html">How to recover a known planet in Kepler data</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.03-appending-lightcurves.html">How to combine lightcurves from different Kepler quarters</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.05-making-custom-apertures.html">How to perform aperture photometry with custom apertures</a></li>
<li class="toctree-l2"><a class="reference internal" href="cutting-out-tpfs-from-tess-ffis.html">How to cut out Target Pixel Files from Kepler Super Stamps or TESS FFIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.08-making-fits-files.html">How to store a light curve in FITS format?</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">How to use lightkurve for asteroseismology</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.10-how-to-make-a-supernova-lightcurve.html">How to make a supernova lightcurve</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="section3.html">Systematics correction using lightkurve</a></li>
</ul>
<p class="caption"><span class="caption-text">About lightkurve</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing and reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing and acknowledging lightkurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other_software.html">Other software</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">lightkurve</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="section2.html">Science with lightkurve</a> &raquo;</li>
        
      <li>How to use lightkurve for asteroseismology</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/2.09-how-to-use-lightkurve-for-asteroseismology.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="How-to-use-lightkurve-for-asteroseismology">
<h1>How to use lightkurve for asteroseismology<a class="headerlink" href="#How-to-use-lightkurve-for-asteroseismology" title="Permalink to this headline">¶</a></h1>
<p>Asteroseismology is the study of stellar oscillations. To see them, we
usually want to transfer from the <em>time domain</em> that light curves are in
to the <em>frequency domain</em>. We can do that with periodograms such as
Fourier Transforms or Lomb-Scargle Periodograms. <code class="docutils literal notranslate"><span class="pre">lightkurve</span></code> has
built in routines for working with data in the <em>frequency domain</em> which
are useful for asteroseismologists.</p>
<p>Below we demonstrate some of the new functionalities in <code class="docutils literal notranslate"><span class="pre">lightkurve</span></code>
and how to use them for asteroseismology.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from lightkurve import KeplerTargetPixelFile
import matplotlib.pyplot as plt
import numpy as np
from lightkurve import log
log.setLevel(&#39;ERROR&#39;)
</pre></div>
</div>
</div>
<p>As an example, we can use a giant star from Campaign 5. You can read
more about asteroseismology with giants in K2 in Stello et al 2015
<a class="reference external" href="https://arxiv.org/pdf/1610.03060.pdf">here</a>.</p>
<p>First we’ll use <code class="docutils literal notranslate"><span class="pre">from_archive</span></code> to download the Target Pixel File for
the target.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>ID = 211416749
tpf = KeplerTargetPixelFile.from_archive(ID, campaign=5, cadence=&#39;short&#39;)
</pre></div>
</div>
</div>
<p>Let’s plot the target below to see if the aperture is centered. We’re
plotting in ‘log’ scale here so that we can see the wings of the PSF.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>tpf.plot(scale=&#39;log&#39;, aperture_mask=tpf.pipeline_mask)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[3]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11c942cf8&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_5_1.png" src="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_5_1.png" />
</div>
</div>
<p>We can now create a <code class="docutils literal notranslate"><span class="pre">LightCurve</span></code> using Simple Aperture Photometry with
the <code class="docutils literal notranslate"><span class="pre">to_lightcurve</span></code> method. We can then normalize, remove NaN values
and remove outliers in one easy line. We can also use the new
<code class="docutils literal notranslate"><span class="pre">fill_gaps</span></code> method to fill in any gaps there are in our data using
linear interpolation of the nearest neighbours. This creates an almost
perfectly sampled time array with no gaps.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lc = tpf.to_lightcurve()
lc = lc.normalize().remove_nans().remove_outliers().fill_gaps()
</pre></div>
</div>
</div>
<p>We can plot our light curve easily with the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lc.plot()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[5]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11ca8cc18&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_9_1.png" src="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_9_1.png" />
</div>
</div>
<p>Let’s take a look at the periodogram for this light curve. You can
create a <code class="docutils literal notranslate"><span class="pre">periodogram</span></code> object using <code class="docutils literal notranslate"><span class="pre">lc.periodogram()</span></code>. This can be
passed any array of frequencies that the user wants, but by default will
create an array of frequency for you. (Frequency values range from
1<span class="math notranslate">\(\mu Hz\)</span> to the nyquist frequency of the data, with <span class="math notranslate">\(N/2\)</span>
points, where <span class="math notranslate">\(N\)</span> is the number of time points in the light
curve.)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>p = lc.periodogram()
</pre></div>
</div>
</div>
<p>With this new periodogram object we can now plot the power spectrum of
the data. Let’s do that now!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>ax = p.plot(c=&#39;k&#39;)

ax.set_xlim(0, 1000)
ax.set_ylim(0, 400)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[7]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(0, 400)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_13_1.png" src="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_13_1.png" />
</div>
</div>
<p>Unfortunately there is some ringing going on…there is a periodicity in
the data due to the K2 motion. But we can apply our own Self Flat
Fielding (SFF) correction to the light curve to remove this. Below we
correct with SFF using the default <code class="docutils literal notranslate"><span class="pre">correct</span></code> function, with
<code class="docutils literal notranslate"><span class="pre">windows=10</span></code>. Windows changes the number of ‘chunks’ we split the
light curve into before detrending. (You can read more about SFF in our
other tutorials.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>lc =  tpf.to_lightcurve().normalize().remove_nans().remove_outliers()
clc = lc.correct(windows=10).remove_outliers().fill_gaps()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
100%|██████████| 10/10 [00:10&lt;00:00,  1.07s/it]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>clc.plot()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1c29a5b8d0&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_16_1.png" src="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_16_1.png" />
</div>
</div>
<p>Our new, corrected lightcurve looks much flatter and has a much smaller
CDPP. Let’s try plotting the periodogram again.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>p_clean = clc.periodogram()
ax = p_clean.plot(c=&#39;k&#39;)

ax.set_xlim(100, 400)
ax.set_ylim(0, 50)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(0, 50)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_18_1.png" src="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_18_1.png" />
</div>
</div>
<p>This is much better! Now we can see the oscillation modes of the target!</p>
<p>We can even find out what effect our detrending parameters have on our
target. Below we change the detrending windows from
<span class="math notranslate">\(w=2\; ... \; 10\)</span> and plot the periodogram in each case. We can
see different detrending parameters has an effect on each of the modes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Create a window to plot into
fig, ax = plt.subplots(1)

# Loop over several windows
for windows in np.arange(2, 12, 2):
    # Create the light curve
    lc =  tpf.to_lightcurve().normalize().remove_nans().remove_outliers()
    clc = lc.correct(windows=windows).remove_outliers().fill_gaps()
    # Create the periodogram
    p_clean = clc.periodogram()
    # Plot the periodogram
    p_clean.plot(ax=ax, alpha=0.4, label=&#39;Windows: {}&#39;.format(windows))

ax.set_xlim(100, 400)
ax.set_ylim(0, 50)
ax.legend()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
100%|██████████| 2/2 [00:10&lt;00:00,  5.37s/it]
100%|██████████| 4/4 [00:09&lt;00:00,  2.45s/it]
100%|██████████| 6/6 [00:10&lt;00:00,  1.68s/it]
100%|██████████| 8/8 [00:10&lt;00:00,  1.29s/it]
100%|██████████| 10/10 [00:10&lt;00:00,  1.02s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[11]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.legend.Legend at 0x1c249c22e8&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_20_2.png" src="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_20_2.png" />
</div>
</div>
<p>We can also easily change the aperture size. If the aperture is too
small, increasing the aperture size should allow us to include more of
the target flux. If there is a contaminant nearby, decreasing the
aperture may increase our singal to noise.</p>
<p>Below we create a new aperture for the target. In this case we’ve used
an aperture where pixels have a value greater than the 70th percentile.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>aper = np.nanmedian(tpf.flux, axis=0) &gt; np.nanpercentile(np.nanmedian(tpf.flux, axis=0), 70)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/Users/ch/miniconda3/lib/python3.6/site-packages/numpy/lib/nanfunctions.py:907: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanmedian1d, axis, a, overwrite_input)
/Users/ch/miniconda3/lib/python3.6/site-packages/ipykernel_launcher.py:1: RuntimeWarning: invalid value encountered in greater
  &#34;&#34;&#34;Entry point for launching an IPython kernel.
</pre></div></div>
</div>
<p>We can plot up our new aperture against the pipeline aperture for
comparison.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Two subplots
fig, axs = plt.subplots(1, 2, figsize=(12, 4))

# Plot pipeline aperture mask
tpf.plot(axs[0], scale=&#39;log&#39;, aperture_mask=tpf.pipeline_mask)
axs[0].set_title(&#39;Pipeline Aperture&#39;)

# Plot larger aperture mask
tpf.plot(axs[1], scale=&#39;log&#39;, aperture_mask=aper)
axs[1].set_title(&#39;Larger Aperture&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[13]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Text(0.5,1,&#39;Larger Aperture&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_24_1.png" src="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_24_1.png" />
</div>
</div>
<p>Now let’s create our two light curves, one with the pipeline aperture
and one with the new aperture.</p>
<p><code class="docutils literal notranslate"><span class="pre">tpf.to_lightcurve()</span></code> creates our SAP flux with the pipeline aperture
as a default. To use a new aperture we simple use
<code class="docutils literal notranslate"><span class="pre">tpf.to_lightcurve(NEW_APERTURE)</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Create the light curve with the pipelien aperture.
lc_pipeline = tpf.to_lightcurve().normalize().remove_nans().remove_outliers()
lc_pipeline = lc_pipeline.correct(windows=10).remove_outliers().fill_gaps()

# Create a light curve with a slightly larger aperture
lc_larger_aperture = tpf.to_lightcurve(aper).normalize().remove_nans().remove_outliers()
lc_larger_aperture = lc_larger_aperture.correct(windows=10).remove_outliers().fill_gaps()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
100%|██████████| 10/10 [00:10&lt;00:00,  1.03s/it]
100%|██████████| 10/10 [00:11&lt;00:00,  1.16s/it]
</pre></div></div>
</div>
<p>When we plot these two light curves we can see that the larger aperture
is much less noisy.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Create subplots to plot into
fig, ax = plt.subplots()

#Plot the pipeline and large aperture light curves
lc_pipeline.plot(ax=ax, label=&#39;Pipeline Aperture&#39;)
lc_larger_aperture.plot(ax=ax, label=&#39;Larger Aperture&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[15]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x113540e80&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_28_1.png" src="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_28_1.png" />
</div>
</div>
<p>Finally, when we plot the periodogram we can see we’ve increased the
signal to noise ratio of our stellar oscillations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Create the periodograms
p_pipeline = lc_pipeline.periodogram()
p_larger_aperture = lc_larger_aperture.periodogram()

# Create subplots to plot into
fig, ax = plt.subplots()
# Plot the periodograms
p_pipeline.plot(ax=ax, c=&#39;k&#39;, alpha=0.5, label=&#39;Pipeline&#39;)
p_larger_aperture.plot(ax=ax, c=&#39;C3&#39;, alpha=0.5, label=&#39;Larger Aperture&#39;)


ax.set_xlim(100, 400)
ax.set_ylim(0, 50)
ax.legend();
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_30_0.png" src="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_30_0.png" />
</div>
</div>
<p>Finally, this target was actually observed twice by K2, once in April
2015 in Campaign 5 and once in December 2017 in Campaign 16. We can get
both of these data sets and compare the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Download the C16 TPF
tpf_c16 = KeplerTargetPixelFile.from_archive(ID, campaign=16, cadence=&#39;short&#39;)

# Create a new &quot;large&quot; aperture where flux is greater than the 70th percentile.
aper = np.nanmedian(tpf_c16.flux, axis=0) &gt; np.nanpercentile(np.nanmedian(tpf_c16.flux, axis=0), 70)

# Create a new light curve for C16
lc_c16 = tpf_c16.to_lightcurve(&#39;all&#39;).normalize().remove_nans().remove_outliers()
lc_c16 = lc_c16.correct(windows=10).remove_outliers().fill_gaps()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/Users/ch/miniconda3/lib/python3.6/site-packages/numpy/lib/nanfunctions.py:907: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanmedian1d, axis, a, overwrite_input)
/Users/ch/miniconda3/lib/python3.6/site-packages/ipykernel_launcher.py:5: RuntimeWarning: invalid value encountered in greater
  &#34;&#34;&#34;
100%|██████████| 10/10 [00:11&lt;00:00,  1.19s/it]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Create the C16 periodogram
p_c16_larger_aperture = lc_c16.periodogram()

# Create subplots to plot into
fig, ax = plt.subplots()
p_larger_aperture.plot(ax=ax, c=&#39;k&#39;, alpha=0.5, label=&#39;C5 (Larger Aperture)&#39;)
p_c16_larger_aperture.plot(ax=ax, c=&#39;C3&#39;, alpha=0.5, label=&#39;C16 (Larger Aperture)&#39;)

ax.set_xlim(100, 400)
ax.set_ylim(0, 50)
ax.legend()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[18]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.legend.Legend at 0x1c308a2320&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_33_1.png" src="../_images/tutorials_2.09-how-to-use-lightkurve-for-asteroseismology_33_1.png" />
</div>
</div>
<p>It looks like the signal to noise in the C16 data set is reduced for
this target. This may be due to the target being closer to the edge of
the detector. Perhaps better detrending parameters and aperture choices
will increase the signal to noise!</p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="2.10-how-to-make-a-supernova-lightcurve.html" class="btn btn-neutral float-right" title="How to make a supernova lightcurve" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="2.08-making-fits-files.html" class="btn btn-neutral" title="How to store a light curve in FITS format?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright lightkurve developers and contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0b9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>